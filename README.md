# 大尺度激光加工系统协同路径规划

## 项目简介

这是一个用于大尺度激光加工系统的协同路径规划程序，采用"自适应网格法引导的K递减K-means聚类算法"进行区域划分，并结合模拟退火、遗传算法和局部搜索的混合优化策略进行路径优化。

## 核心算法

1. **自适应网格法**: 快速获得初始可行区域覆盖的中心及数量K0
2. **K递减K-means聚类**: 通过迭代递减K值，自动寻找能够完全覆盖所有加工点的最小区域数及其中心位置
3. **时间评估模型**: 精确模拟平台移动与振镜扫描之间的并行与等待关系
4. **混合优化算法**: 结合模拟退火(SA)、遗传算法(GA)和局部搜索的优势，自适应选择优化策略

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 基本使用

```bash
python main.py
```

### 配置参数

编辑 `config.yaml` 文件调整系统参数：

```yaml
# 系统参数
v1: 100.0  # 平台速度 mm/s
v2: 2000.0  # 振镜速度 mm/s
L: 50.0  # 振镜覆盖区域边长 mm

# 输入输出
input_svg: "data/pattern.svg"
output_image: "results/path_planning.png"
output_json: "results/path_planning.json"
```

## 输出结果

程序运行完成后，会在 `results/` 目录下生成以下文件：

1. `path_planning.png`: 综合可视化图表，包含：
   - 加工点分布与区域划分
   - 平台运动路径
   - 协同加工时间线

2. `path_planning_metrics.png`: 关键性能指标图表

3. `path_planning.json`: 详细的结果数据，包含：
   - 配置参数
   - 性能指标
   - 平台路径序列
   - 详细时间线

## 模块说明

- `main.py`: 主程序入口
- `config.py`: 参数配置管理
- `svg_parser.py`: SVG文件解析（支持贝塞尔曲线）
- `adaptive_grid.py`: 自适应网格生成
- `kmeans_decrement.py`: K递减K-means聚类算法
- `tsp_solver.py`: TSP路径求解（最近邻+2-opt/3-opt）
- `hybrid_optimizer.py`: 混合优化器（SA+GA+局部搜索）
- `time_evaluator.py`: 时间评估模型
- `coordinator.py`: 协同路径调度
- `visualizer.py`: Matplotlib可视化
- `metrics.py`: 性能指标计算

## 项目结构

```
laser_path_planning/
├── main.py                    # 主程序
├── config.py                  # 配置管理
├── config.yaml                # 配置文件
├── requirements.txt           # 依赖列表
├── svg_parser.py              # SVG解析
├── adaptive_grid.py           # 自适应网格
├── kmeans_decrement.py        # K递减聚类
├── tsp_solver.py              # TSP求解
├── hybrid_optimizer.py        # 混合优化
├── time_evaluator.py          # 时间评估
├── coordinator.py             # 协同调度
├── visualizer.py              # 可视化
├── metrics.py                 # 指标计算
├── data/                      # 数据目录
│   └── pattern.svg           # 输入SVG文件
└── results/                   # 结果目录
    ├── path_planning.png     # 可视化结果
    ├── path_planning_metrics.png
    └── path_planning.json    # 结果数据
```

## 性能指标

程序计算以下关键指标：

- 总加工点数、区域数量、覆盖率
- 平台路径长度、移动时间
- 激光扫描时间、等待时间
- 总加工时间、时间利用率
- 区域均衡度

## 算法特点

1. **保证高覆盖率**: 目标覆盖率可配置（默认99.9%）
2. **严格方形约束**: 确保每个区域严格限制在L×L的方形范围内
3. **自适应优化**: 根据问题规模自动选择最优的混合优化策略
4. **并行时间模拟**: 精确计算平台移动与振镜扫描的并行关系

## 示例

如果输入文件不存在，程序会自动生成一个测试SVG文件进行演示。

```bash
python main.py
```

输出示例：

```
============================================================
  大尺度激光加工系统协同路径规划
  自适应网格法引导的K递减K-means聚类 + 混合优化算法
============================================================

系统参数:
  平台速度 v1: 100.0 mm/s
  振镜速度 v2: 2000.0 mm/s
  覆盖区域边长 L: 50.0 mm

============================================================
  1. SVG解析
============================================================
解析完成，共 360 个加工点

============================================================
  2. 自适应网格法
============================================================
自适应网格生成初始K值: 16

============================================================
  3. K递减K-means聚类
============================================================
K=16, 覆盖率: 1.0000
...
最终选择K=4, 覆盖率: 1.0000

============================================================
  4. TSP初始路径求解
============================================================
TSP初始路径长度: 325.45 mm

============================================================
  5. 时间评估模型
============================================================
初始路径总耗时: 5.23 s

============================================================
  6. 混合优化 (SA + GA + 局部搜索)
============================================================
中等规模问题: 采用GA优先策略
...
优化后路径总耗时: 4.87 s
时间改进: 6.89%

============================================================
  路径规划完成！
============================================================
```

## 哈尔滨工业大学（深圳）数学建模竞赛

本项目为哈工大（深圳）数学建模竞赛A题"大尺度激光加工系统的协同路径规划"的解决方案。
